{
  "title": "Creating a Basic Agent",
  "objectives": [
    "Build a minimal working agent with AgentCore",
    "Understand the agent entry point pattern",
    "Test locally and deploy to AgentCore Runtime"
  ],
  "content": "# Creating a Basic Agent\n\nNow that your environment is set up, let's build your first agent. We'll start with the simplest possible agent and then deploy it to AgentCore.\n\n## The Minimal Agent\n\nCreate `agent.py`:\n\n```python\nfrom bedrock_agentcore import BedrockAgentCoreApp\nfrom strands import Agent\n\n# Initialize the AgentCore application\napp = BedrockAgentCoreApp()\n\n# Create a simple agent (uses Claude by default)\nagent = Agent()\n\n@app.entrypoint\ndef invoke(payload):\n    \"\"\"Entry point for agent invocations.\"\"\"\n    # Get the user's message from the payload\n    user_message = payload.get(\"prompt\", \"Hello!\")\n    \n    # Run the agent\n    result = agent(user_message)\n    \n    # Return the response\n    return {\"result\": result.message}\n\nif __name__ == \"__main__\":\n    app.run()\n```\n\nThat's it! Let's break down what each part does.\n\n## Understanding the Code\n\n### BedrockAgentCoreApp\n\n```python\nfrom bedrock_agentcore import BedrockAgentCoreApp\napp = BedrockAgentCoreApp()\n```\n\nThis creates the AgentCore application wrapper. It handles:\n- HTTP server setup\n- Request/response formatting\n- Container lifecycle management\n- Integration with AgentCore Runtime\n\n### Strands Agent\n\n```python\nfrom strands import Agent\nagent = Agent()\n```\n\nStrands is AWS's agent framework. The `Agent` class:\n- Connects to Amazon Bedrock (Claude by default)\n- Manages conversation context\n- Handles tool execution\n- Provides streaming support\n\n### The Entry Point\n\n```python\n@app.entrypoint\ndef invoke(payload):\n    ...\n```\n\nThe `@app.entrypoint` decorator marks this function as the handler for incoming requests. Every request to your agent comes through here.\n\n**Payload Structure:**\n```python\n{\n    \"prompt\": \"User's message\",\n    \"user_id\": \"optional-user-id\",\n    \"session_id\": \"optional-session-id\",\n    # ... any other fields you need\n}\n```\n\n### Running the Agent\n\n```python\nresult = agent(user_message)\nreturn {\"result\": result.message}\n```\n\nCall the agent with the user's message. The result object contains:\n- `result.message` - The text response\n- `result.tools_used` - List of tools that were called\n- `result.token_usage` - Token consumption stats\n\n## Test Locally\n\nStart your agent:\n\n```bash\npython agent.py\n```\n\nYou'll see:\n```\nStarting AgentCore application...\nListening on http://localhost:8080\n```\n\nIn another terminal, send a request:\n\n```bash\ncurl -X POST http://localhost:8080/invocations \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"prompt\": \"Hello! Tell me a joke.\"}'\n```\n\nResponse:\n```json\n{\n  \"result\": \"Why did the scarecrow win an award? Because he was outstanding in his field!\"\n}\n```\n\n## Customizing Your Agent\n\n### Custom System Prompt\n\n```python\nagent = Agent(\n    system_prompt=\"\"\"You are a helpful customer service agent for Acme Corp.\n    Be friendly, concise, and always ask if there's anything else you can help with.\n    If you don't know something, say so rather than making things up.\"\"\"\n)\n```\n\n### Specifying a Model\n\n```python\nagent = Agent(\n    model=\"anthropic.claude-3-5-sonnet-20241022-v2:0\"\n)\n```\n\n### Adjusting Temperature\n\n```python\nagent = Agent(\n    temperature=0.7  # More creative (0.0 = deterministic, 1.0 = creative)\n)\n```\n\n## Deploy to AgentCore\n\n### Step 1: Configure\n\n```bash\nagentcore configure -e agent.py\n```\n\nThis creates a configuration file with deployment settings.\n\n### Step 2: Launch\n\n```bash\nagentcore launch\n```\n\nThis command:\n1. **Packages** your code and dependencies\n2. **Builds** a container image\n3. **Pushes** to Amazon ECR\n4. **Deploys** to AgentCore Runtime\n5. **Returns** your agent's endpoint URL\n\nOutput:\n```\nPackaging agent...\nBuilding container...\nPushing to ECR...\nDeploying to AgentCore...\n\nAgent deployed successfully!\nEndpoint: https://abc123.agentcore.us-east-1.amazonaws.com\n```\n\n### Step 3: Test Deployed Agent\n\n```bash\nagentcore invoke '{\"prompt\": \"Tell me about AI agents\"}'\n```\n\nOr use curl:\n\n```bash\ncurl -X POST https://abc123.agentcore.us-east-1.amazonaws.com/invocations \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Authorization: Bearer $AGENTCORE_TOKEN\" \\\n  -d '{\"prompt\": \"Tell me about AI agents\"}'\n```\n\n## Handling Errors\n\nAdd error handling to your entry point:\n\n```python\n@app.entrypoint\ndef invoke(payload):\n    try:\n        user_message = payload.get(\"prompt\")\n        if not user_message:\n            return {\"error\": \"Missing 'prompt' in request\"}\n        \n        result = agent(user_message)\n        return {\"result\": result.message}\n        \n    except Exception as e:\n        # Log the error (visible in CloudWatch)\n        print(f\"Error: {e}\")\n        return {\"error\": \"An error occurred processing your request\"}\n```\n\n## Streaming Responses\n\nFor real-time responses, enable streaming:\n\n```python\n@app.entrypoint\ndef invoke(payload):\n    user_message = payload.get(\"prompt\", \"Hello!\")\n    \n    # Stream the response\n    for chunk in agent.stream(user_message):\n        yield {\"chunk\": chunk.content}\n    \n    yield {\"done\": True}\n```\n\n## Viewing Logs\n\nCheck your agent's logs:\n\n```bash\n# View recent logs\nagentcore logs\n\n# Follow logs in real-time\nagentcore logs --follow\n\n# View logs from last hour\nagentcore logs --since 1h\n```\n\n## What's Happening Behind the Scenes\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                    Your Request                              │\n│    {\"prompt\": \"Hello!\"}                                     │\n└─────────────────────────────┬───────────────────────────────┘\n                              │\n                              ▼\n┌─────────────────────────────────────────────────────────────┐\n│                AgentCore Runtime                             │\n│  ┌─────────────────────────────────────────────────────┐    │\n│  │  Your Container                                      │    │\n│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  │    │\n│  │  │ BedrockApp  │──│   Agent     │──│  Bedrock    │  │    │\n│  │  │ (receives   │  │ (processes  │  │  Claude     │  │    │\n│  │  │  request)   │  │  message)   │  │  (LLM)      │  │    │\n│  │  └─────────────┘  └─────────────┘  └─────────────┘  │    │\n│  └─────────────────────────────────────────────────────┘    │\n└─────────────────────────────┬───────────────────────────────┘\n                              │\n                              ▼\n┌─────────────────────────────────────────────────────────────┐\n│                    Response                                  │\n│    {\"result\": \"Hello! How can I help you today?\"}          │\n└─────────────────────────────────────────────────────────────┘\n```\n\n## Next Steps\n\nYour basic agent is running! In the next lesson, we'll add custom tools to give your agent real capabilities - like checking the time, performing calculations, or calling external APIs."
}
