{
  "title": "Architecture Design",
  "objectives": [
    "Design a complete agent architecture using AgentCore services",
    "Create tool specifications with proper schemas",
    "Plan your memory strategy for conversation context"
  ],
  "content": "# Architecture Design\n\nWith your project requirements defined, it's time to design how your agent will actually work. A good architecture makes implementation straightforward; a poor one creates endless debugging.\n\n## The Architecture Document\n\nEvery production agent needs a design document. Here's what yours should include:\n\n1. **System Overview** - What the agent does (one paragraph)\n2. **Service Map** - Which AgentCore services you'll use\n3. **Tool Definitions** - Detailed specs for each tool\n4. **Memory Strategy** - How you'll manage context\n5. **Data Flow** - How information moves through the system\n\n## Step 1: Service Map\n\nIdentify which AgentCore services your agent needs:\n\n```\n┌─────────────────────────────────────────────────────────┐\n│                    YOUR AGENT                           │\n├─────────────────────────────────────────────────────────┤\n│                                                         │\n│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │\n│  │   Runtime   │  │   Memory    │  │    Tool     │     │\n│  │   Service   │  │   Service   │  │   Service   │     │\n│  │             │  │             │  │             │     │\n│  │ ☑ Required  │  │ ☐ Optional  │  │ ☑ Required  │     │\n│  └─────────────┘  └─────────────┘  └─────────────┘     │\n│                                                         │\n│  ┌─────────────┐  ┌─────────────┐                      │\n│  │  Identity   │  │   Gateway   │                      │\n│  │   Service   │  │   Service   │                      │\n│  │             │  │             │                      │\n│  │ ☐ Optional  │  │ ☑ Required  │                      │\n│  └─────────────┘  └─────────────┘                      │\n│                                                         │\n└─────────────────────────────────────────────────────────┘\n```\n\n**For each service, document:**\n- Why you need it (or why you don't)\n- How you'll configure it\n- Any special requirements\n\n### Example: Customer Support Agent\n\n| Service | Used? | Purpose |\n|---------|-------|--------|\n| Runtime Service | Yes | Execute agent logic, manage conversation |\n| Memory Service | Yes | Store conversation history, user preferences |\n| Tool Service | Yes | Search FAQ, check order status |\n| Identity Service | No | Not needed for anonymous support |\n| Gateway Service | Yes | Expose agent via API |\n\n## Step 2: Tool Definitions\n\nThis is the most important part. Well-defined tools make your agent reliable; vague tools cause confusion.\n\n### Tool Specification Template\n\nFor each tool, define:\n\n```json\n{\n  \"name\": \"search_faq\",\n  \"description\": \"Searches the FAQ knowledge base for answers to customer questions. Returns the most relevant FAQ entries with their answers.\",\n  \"parameters\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"query\": {\n        \"type\": \"string\",\n        \"description\": \"The customer's question or keywords to search for\"\n      },\n      \"category\": {\n        \"type\": \"string\",\n        \"enum\": [\"shipping\", \"returns\", \"billing\", \"product\", \"general\"],\n        \"description\": \"Optional category to narrow the search\"\n      },\n      \"max_results\": {\n        \"type\": \"integer\",\n        \"default\": 3,\n        \"description\": \"Maximum number of FAQ entries to return\"\n      }\n    },\n    \"required\": [\"query\"]\n  },\n  \"returns\": {\n    \"type\": \"array\",\n    \"items\": {\n      \"question\": \"string\",\n      \"answer\": \"string\",\n      \"relevance_score\": \"number\"\n    }\n  }\n}\n```\n\n### Tool Description Best Practices\n\n**Be specific about:**\n- What the tool does\n- When to use it\n- What it returns\n- Edge cases and limitations\n\n**Bad description:**\n```\n\"Searches for stuff\"\n```\n\n**Good description:**\n```\n\"Searches the FAQ knowledge base for answers to customer questions. \nUse this when the customer asks about policies, procedures, or product information. \nReturns up to 3 matching FAQ entries ranked by relevance. \nIf no matches found, returns an empty array - consider rephrasing the search or escalating.\"\n```\n\n### Common Tool Patterns\n\n**Retrieval Tool:**\n```json\n{\n  \"name\": \"get_order_status\",\n  \"description\": \"Retrieves the current status of a customer order by order ID\",\n  \"parameters\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"order_id\": {\n        \"type\": \"string\",\n        \"pattern\": \"^ORD-[0-9]{6}$\",\n        \"description\": \"Order ID in format ORD-XXXXXX\"\n      }\n    },\n    \"required\": [\"order_id\"]\n  }\n}\n```\n\n**Action Tool:**\n```json\n{\n  \"name\": \"create_support_ticket\",\n  \"description\": \"Creates a support ticket for issues that require human follow-up\",\n  \"parameters\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"subject\": {\n        \"type\": \"string\",\n        \"maxLength\": 100\n      },\n      \"description\": {\n        \"type\": \"string\",\n        \"maxLength\": 1000\n      },\n      \"priority\": {\n        \"type\": \"string\",\n        \"enum\": [\"low\", \"medium\", \"high\", \"urgent\"]\n      }\n    },\n    \"required\": [\"subject\", \"description\"]\n  }\n}\n```\n\n## Step 3: Memory Strategy\n\nDecide how your agent will remember information:\n\n### Conversation Memory\nHow many turns of conversation to remember?\n\n```python\nmemory_config = {\n    \"type\": \"sliding_window\",\n    \"window_size\": 10,  # Last 10 messages\n    \"include_system\": False\n}\n```\n\n### Session Memory\nWhat to remember within a single session?\n\n```python\nsession_state = {\n    \"user_name\": None,\n    \"order_id\": None,  # If they mention an order\n    \"issue_category\": None,\n    \"escalation_attempted\": False\n}\n```\n\n### Long-term Memory\nWhat to remember across sessions? (if applicable)\n\n```python\nuser_profile = {\n    \"preferences\": {},\n    \"past_issues\": [],\n    \"satisfaction_scores\": []\n}\n```\n\n## Step 4: Data Flow Diagram\n\nVisualize how information moves through your system:\n\n```\n┌──────────┐     ┌──────────────┐     ┌────────────┐\n│  User    │────▶│   Gateway    │────▶│  Runtime   │\n│  Input   │     │   Service    │     │  Service   │\n└──────────┘     └──────────────┘     └─────┬──────┘\n                                            │\n                      ┌─────────────────────┼─────────────────────┐\n                      │                     │                     │\n                      ▼                     ▼                     ▼\n               ┌────────────┐       ┌────────────┐       ┌────────────┐\n               │   Memory   │       │   Tool:    │       │   Tool:    │\n               │   Service  │       │ search_faq │       │ get_order  │\n               └────────────┘       └────────────┘       └────────────┘\n                      │                     │                     │\n                      └─────────────────────┼─────────────────────┘\n                                            │\n                                            ▼\n                                     ┌────────────┐\n                                     │  Response  │\n                                     │ Generation │\n                                     └─────┬──────┘\n                                            │\n                                            ▼\n                                     ┌────────────┐\n                                     │   User     │\n                                     │  Output    │\n                                     └────────────┘\n```\n\n## Step 5: Error Handling Strategy\n\nPlan for failures before they happen:\n\n| Failure Mode | Detection | Response |\n|--------------|-----------|----------|\n| Tool timeout | 30s limit | Apologize, retry once, then offer alternative |\n| No FAQ match | Empty results | Ask clarifying question or escalate |\n| Invalid input | Schema validation | Ask user to rephrase |\n| Rate limit | 429 error | Queue request, inform user of delay |\n\n## Your Architecture Document\n\nCreate a document with these sections:\n\n```markdown\n# [Your Agent Name] - Architecture Design\n\n## 1. System Overview\n[One paragraph describing what your agent does]\n\n## 2. Service Map\n| Service | Used | Purpose |\n|---------|------|----------|\n| Runtime | Yes/No | ... |\n| Memory | Yes/No | ... |\n| Tool | Yes/No | ... |\n| Identity | Yes/No | ... |\n| Gateway | Yes/No | ... |\n\n## 3. Tool Definitions\n### Tool 1: [name]\n[Full JSON schema]\n\n### Tool 2: [name]\n[Full JSON schema]\n\n## 4. Memory Strategy\n- Conversation window: [N] messages\n- Session state: [what you track]\n- Long-term: [if applicable]\n\n## 5. Data Flow\n[ASCII diagram or description]\n\n## 6. Error Handling\n| Failure | Detection | Response |\n|---------|-----------|----------|\n```\n\n## Your Assignment\n\nBefore moving on:\n\n1. **Complete your architecture document** using the template above\n2. **Define at least 2 tools** with full JSON schemas\n3. **Decide your memory strategy** - how much context to keep\n4. **Draw your data flow** - even a simple sketch helps\n\nShare your architecture with the AI tutor for feedback. It can help identify gaps or suggest improvements.\n\n## What's Next\n\nIn the next lesson, you'll implement your agent based on this design. The architecture document becomes your implementation roadmap."
}
